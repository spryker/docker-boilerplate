{% include "nginx/conf.d/common.conf.twig" with _context %}

{% for groupData in groups %}
{% for applicationName, applicationData in groupData['applications'] %}
{% if applicationData['application'] == 'zed' %}

upstream {{ applicationName }} {
    server {{ applicationName }}:9000;
}

{% for domain, domainData in applicationData['domain'] %}
{# Ignoring custom port and SSL within internal networn #}
{% include "nginx/rpc.server.conf.twig" with {
    domain: domain,
    domainData: domainData,
    upstream: applicationName,
    project: _context
} %}

{% endfor %}
{% endif %}
{% endfor %}
{% endfor %}
